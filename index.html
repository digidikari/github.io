<script>
    // Fungsi untuk memuat game dari GamePix
    async function loadGames() {
        try {
            const response = await fetch('https://feeds.gamepix.com/v2/json?sid=ANA26&pagination=12&page=1');
            const data = await response.json();
            
            // Format data sesuai kebutuhan
            const formattedGames = data.data.map(game => ({
                title: game.title,
                genre: game.category,
                image: game.image,
                url: game.url,
                players: game.installs ? parseInt(game.installs).toLocaleString() : '10K+',
                rating: game.rating ? game.rating.toFixed(1) : '4.5'
            }));

            generateGameCards(formattedGames);
            setupSearch(formattedGames);
            updateSidebarCategories(formattedGames);

        } catch (error) {
            console.error('Gagal memuat game:', error);
            document.getElementById('gameGrid').innerHTML = `
                <div class="error-message">
                    <p>‚ö†Ô∏è Gagal memuat data game. Silakan refresh halaman atau coba lagi nanti.</p>
                </div>
            `;
        }
    }

    // Generate kartu game dari data GamePix
    function generateGameCards(games) {
        const grid = document.getElementById('gameGrid');
        grid.innerHTML = games.map(game => `
            <div class="game-card" onclick="window.open('${game.url}', '_blank')">
                <img src="${game.image}" class="game-thumbnail" alt="${game.title}">
                <div class="game-info">
                    <h3 class="game-title">${game.title}</h3>
                    <div class="game-meta">
                        <span class="game-genre">${game.genre}</span>
                        <span>‚≠ê ${game.rating}</span>
                    </div>
                    <div class="game-meta">
                        <span>üë• ${game.players}</span>
                        <span>üéÆ GamePIX</span>
                    </div>
                </div>
            </div>
        `).join('');
    }

    // Update kategori sidebar secara dinamis
    function updateSidebarCategories(games) {
        const categories = [...new Set(games.map(game => game.genre))];
        const categoryList = document.querySelector('.sidebar-menu');
        
        categoryList.innerHTML = categories.map(category => `
            <li class="menu-item" onclick="filterByCategory('${category}')">
                üïπÔ∏è ${category}
            </li>
        `).join('');
    }

    // Filter berdasarkan kategori
    function filterByCategory(category) {
        const gameCards = document.querySelectorAll('.game-card');
        gameCards.forEach(card => {
            const cardCategory = card.querySelector('.game-genre').textContent;
            card.style.display = (category === 'All' || cardCategory === category) 
                ? 'block' 
                : 'none';
        });
    }

    // Setup pencarian
    function setupSearch(games) {
        document.querySelector('.search-input').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = games.filter(game => 
                game.title.toLowerCase().includes(term) || 
                game.genre.toLowerCase().includes(term)
            );
            generateGameCards(filtered);
        });
    }

    // Inisialisasi
    document.addEventListener('DOMContentLoaded', loadGames);
</script>
